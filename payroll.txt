echo "Welcome to employee payroll database program"
ysql> show databases
    -> ;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sakila             |
| sys                |
| world              |
+--------------------+
6 rows in set (2.10 sec)

mysql> create database
    -> ;


mysql> show databases;
+---------------------------+
| Database                  |
+---------------------------+
| employee_payroll_database |
| information_schema        |
| mysql                     |
| performance_schema        |
| sakila                    |
| sys                       |
| world                     |
+---------------------------+
7 rows in set (0.00 se

//UC2-create employee payroll table
mysql> create table employee_payroll
    -> (
    ->    id          int unsigned not null auto_increment,
    ->    name        varchar(150) not null,
    ->    salary      double not null,
    ->    start       date not null,
    ->    primary key (id)
    -> );
Query OK, 0 rows affected (2.11 sec)

mysql> describe employee_payroll;
+--------+--------------+------+-----+---------+----------------+
| Field  | Type         | Null | Key | Default | Extra          |
+--------+--------------+------+-----+---------+----------------+
| id     | int unsigned | NO   | PRI | NULL    | auto_increment |
| name   | varchar(150) | NO   |     | NULL    |                |
| salary | double       | NO   |     | NULL    |                |
| start  | date         | NO   |     | NULL    |                |
+--------+--------------+------+-----+---------+----------------+
4 rows in set (0.16 sec)

//UC3 Curd operation -insert data into the created database


mysql>  insert into employee_payroll (name,salary,start) values
    ->    ('Bill',1000000.00,'2018-01-03'),
    ->    ('Terisa',2000000.00,'2019-11-13'),
    ->    ('Charlie',3000000.00,'2020-05-21');
Query OK, 3 rows affected (0.30 sec)
Records: 3  Duplicates: 0  Warnings: 0

//UC4 Retrieve data from the database using select
mysql> select * from employee_payroll;
+----+---------+---------+------------+
| id | name    | salary  | start      |
+----+---------+---------+------------+
|  1 | Bill    | 1000000 | 2018-01-03 |
|  2 | Terisa  | 2000000 | 2019-11-13 |
|  3 | Charlie | 3000000 | 2020-05-21 |
+----+---------+---------+------------+
3 rows in set (0.01 sec)

//UC4-Retrieve salary from particular date
mysql> select*from employee_payroll
    ->     where start between cast('2019-01-01' as date) and date(now());
+----+---------+---------+------------+
| id | name    | salary  | start      |
+----+---------+---------+------------+
|  2 | Terisa  | 2000000 | 2019-11-13 |
|  3 | Charlie | 3000000 | 2020-05-21 |
+----+---------+---------+------------+
2 rows in set (0.03 sec)

//UC5-Retrieve salary of a particular employee 
/////-Retrieve salary from particular date


mysql> select*from employee_payroll
    ->     where start between cast('2019-01-01' as date) and date(now());
+----+---------+---------+------------+
| id | name    | salary  | start      |
+----+---------+---------+------------+
|  2 | Terisa  | 2000000 | 2019-11-13 |
|  3 | Charlie | 3000000 | 2020-05-21 |
+----+---------+---------+------------+
2 rows in set (0.03 sec)

mysql> select salary from employee_payroll
    -> where name='Bill';
+---------+
| salary  |
+---------+
| 1000000 |
+---------+
1 row in set (0.00 sec)

//UC6-alter the table to add gender to the employees


mysql> ALTER TABLE employee_payroll ADD gender char(1) AFTER name;
Query OK, 0 rows affected (3.31 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> update employee_payroll set gender ='F' where name='Terisa';
Query OK, 1 row affected (0.08 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select*from employee_payroll;
+----+---------+--------+---------+------------+
| id | name    | gender | salary  | start      |
+----+---------+--------+---------+------------+
|  1 | Bill    | NULL   | 1000000 | 2018-01-03 |
|  2 | Terisa  | F      | 2000000 | 2019-11-13 |
|  3 | Charlie | NULL   | 3000000 | 2020-05-21 |
+----+---------+--------+---------+------------+
3 rows in set (0.00 sec)

mysql> update employee_payroll set gender ='M' where name='Bill' or name='Charlie';
Query OK, 2 rows affected (0.13 sec)
Rows matched: 2  Changed: 2  Warnings: 0

mysql> select*from employee_payroll;
+----+---------+--------+---------+------------+
| id | name    | gender | salary  | start      |
+----+---------+--------+---------+------------+
|  1 | Bill    | M      | 1000000 | 2018-01-03 |
|  2 | Terisa  | F      | 2000000 | 2019-11-13 |
|  3 | Charlie | M      | 3000000 | 2020-05-21 |
+----+---------+--------+---------+------------+
3 rows in set (0.00 sec)


//UC7-execute different functions in sql like count,min,nax,avg to sorting DB
mysql> select gender,avg(salary) gender from employee_payroll group by gender;
+--------+---------+
| gender | gender  |
+--------+---------+
| M      | 2000000 |
| F      | 2000000 |
+--------+---------+
2 rows in set, 1 warning (0.07 sec)

mysql> select gender,avg(salary) from employee_payroll where gender='M' group by gender;
+--------+-------------+
| gender | avg(salary) |
+--------+-------------+
| M      |     2000000 |
+--------+-------------+
1 row in set (0.00 sec)

mysql> select name,min(salary) gender from employee_payroll group by gender;
+--------+---------+
| name   | gender  |
+--------+---------+
| Bill   | 1000000 |
| Terisa | 2000000 |
+--------+---------+
2 rows in set, 1 warning (0.12 sec)

mysql> select gender,max(salary) gender from employee_payroll group by gender;
+--------+---------+
| gender | gender  |
+--------+---------+
| M      | 3000000 |
| F      | 2000000 |
+--------+---------+
2 rows in set, 1 warning (0.00 sec)

mysql> select count(*) from employee_payroll;
+----------+
| count(*) |
+----------+
|        3 |
+----------+
1 row in set (0.01 sec)

mysql> select gender,sum(salary) gender from employee_payroll group by gender;
+--------+---------+
| gender | gender  |
+--------+---------+
| M      | 4000000 |
| F      | 2000000 |
+--------+---------+
2 rows in set, 1 warning (0.00 sec) 

//UC8-Update phoone no., address and department
mysql> ALTER TABLE employee_payroll ADD phone BIGINT AFTER name;
Query OK, 0 rows affected (9.83 sec)
Records: 0  Duplicates: 0  Warnings: 0
mysql> UPDATE employee_payroll SET address='Nagpur';
Query OK, 3 rows affected (1.52 sec)
Rows matched: 3  Changed: 3  Warnings: 0
mysql> select * from employee_payroll;
+----+---------+-------+--------------+---------+------------+--------+---------+------------+
| id | name    | phone | phone_number | address | department | gender | salary  | start      |
+----+---------+-------+--------------+---------+------------+--------+---------+------------+
|  1 | Bill    |  NULL | NULL         | Nagpur  |            | M      | 1000000 | 2018-01-03 |
|  2 | Terisa  |  NULL | NULL         | Nagpur  |            | F      | 2000000 | 2019-11-13 |
|  3 | Charlie |  NULL | NULL         | Nagpur  |            | M      | 3000000 | 2020-05-21 |
+----+---------+-------+--------------+---------+------------+--------+---------+------------+
3 rows in set (0.09 sec)

//UC9 - Ability to extend employee_payroll to have Basic Pay, Deductions, Taxable Pay, Income Tax and Net Pay

mysql> ALTER TABLE employee_payroll RENAME COLUMN salary TO basic_pay;
Query OK, 0 rows affected (5.08 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> ALTER TABLE employee_payroll ADD deductions DOUBLE NOT NULL AFTER basic_pay;
Query OK, 0 rows affected (3.49 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> ALTER TABLE employee_payroll ADD taxable_pay DOUBLE NOT NULL AFTER deductions;
Query OK, 0 rows affected (5.77 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> ALTER TABLE employee_payroll ADD income_tax DOUBLE NOT NULL AFTER taxable_pay;
Query OK, 0 rows affected (6.08 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> ALTER TABLE employee_payroll ADD net_pay DOUBLE NOT NULL AFTER taxable_pay;
Query OK, 0 rows affected (6.66 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> DESCRIBE employee_payroll;
+--------------+--------------+------+-----+---------+----------------+
| Field        | Type         | Null | Key | Default | Extra          |
+--------------+--------------+------+-----+---------+----------------+
| id           | int unsigned | NO   | PRI | NULL    | auto_increment |
| name         | varchar(150) | NO   |     | NULL    |                |
| phone        | bigint       | YES  |     | NULL    |                |
| phone_number | varchar(250) | YES  |     | NULL    |                |
| address      | varchar(250) | YES  |     | TBD     |                |
| department   | varchar(150) | NO   |     | NULL    |                |
| gender       | char(1)      | YES  |     | NULL    |                |
| basic_pay    | double       | NO   |     | NULL    |                |
| deductions   | double       | NO   |     | NULL    |                |
| taxable_pay  | double       | NO   |     | NULL    |                |
| net_pay      | double       | NO   |     | NULL    |                |
| income_tax   | double       | NO   |     | NULL    |                |
| start        | date         | NO   |     | NULL    |                |
+--------------+--------------+------+-----+---------+----------------+
13 rows in set (0.39 sec)

///UC10-create new table to add employee details
mysql> Insert into Employee_Details ( Name, Gender, Mobile_Number , Address, Experience, emailId) values ( 'Bill', 'M' ,'1325469781' , 'Mumbai' ,  '4 Years', 'lubill@hotmail.com'),
    ->  ( 'Mark',  'M' , ' 789546122' , 'shimla', '3 Years', 'garysmith@cop.in'),
    ->  ( 'Charlie', 'F' , '546981322', 'japan' , '2 Years', 'terisa2@gmial.com');
Query OK, 3 rows affected (0.38 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> Select * From employee_Details;
+------------+---------+--------+---------------+---------+------------+--------------------+
| EmployeeID | Name    | Gender | Mobile_Number | Address | Experience | EmailId            |
+------------+---------+--------+---------------+---------+------------+--------------------+
|          1 | Bill    | M      |    1325469781 | Mumbai  | 4 Years    | lubill@hotmail.com |
|          2 | Mark    | M      |     789546122 | shimla  | 3 Years    | garysmith@cop.in   |
|          3 | Charlie | F      |     546981322 | japan   | 2 Years    | terisa2@gmial.com  |
+------------+---------+--------+---------------+---------+------------+--------------------+
3 rows in set (0.00 sec)

///UC11_add_department

mysql> create table employee_department
    -> (
    -> Id                 int NOT Null auto_increment,
    -> EmpId              int Not Null,
    -> DeptName           varchar(45) Not null,
    -> Primary key(Id),
    -> FOREIGN KEY (EmpId) REFERENCES employee_details(EmployeeID) ON DELETE CASCADE
    -> );
Query OK, 0 rows affected (0.86 sec)

mysql> Insert into employee_department ( EmpId, DeptName) values (  '1', 'Finance'),
    ->   (  '2', 'Sales'),
    ->   ( '3', 'Marketing');
Query OK, 3 rows affected (0.53 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> select * from employee_department;
+----+-------+-----------+
| Id | EmpId | DeptName  |
+----+-------+-----------+
|  1 |     1 | Finance   |
|  2 |     2 | Sales     |
|  3 |     3 | Marketing |
+----+-------+-----------+
3 rows in set (0.00 sec)

mysql> Insert into employee_department ( EmpId, DeptName) values (  '3', 'HR');
Query OK, 1 row affected (0.14 sec)
